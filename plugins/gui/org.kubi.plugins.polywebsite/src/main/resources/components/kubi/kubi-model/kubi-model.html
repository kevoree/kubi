<link rel="import" href="../../bower_components/polymer/polymer.html">
<script src="/js/js/org.kubi.model-all.js"></script>
<script src="/js/js/org.kevoree.modeling.database.websocket.WebSocket.js"></script>

<dom-module name="kubi-model">
    <template>

    </template>
</dom-module>

<script>
    Polymer({
        is: "kubi-model",
        ready: function() {
            var selfKubiModel = this;
            if(!modelConnectedVar) {
                kubiModel2  = new org.kubi.KubiModel();
                var dataBaseConnection2 = new org.kevoree.modeling.database.websocket.WebSocketClient("ws://" + location.host + "/cdn");
                kubiModel2.setContentDeliveryDriver(dataBaseConnection2);
                kubiModel2.connect().then(function(err){
                    if(err) {
                        console.error(err);
                    } else {
                        modelConnectedVar = true;
                        console.log("The model is initializing in the kubi-model component.")
                        selfKubiModel.fire("model-connected", {value: kubiModel2});
                    }
                });
            }
        },
        get model() {
            return kubiModel2;
        },
        get modelConnectedV(){
            return modelConnectedVar;
        },
        modelAvailable : function() {
            return modelConnectedVar;
        },
        get lastTime() {
            return last_timestamp2;
        }
    });
</script>
<script>
    var kubiModel2;
    var modelConnectedVar = false;

</script>