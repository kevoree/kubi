<link rel="import" href="../../bower_components/polymer/polymer.html">
<script src="/js/js/org.kubi.model-all.js"></script>
<script src="/js/js/org.kevoree.modeling.database.websocket.WebSocket.js"></script>

<dom-module name="kubi-model">
    <template>

    </template>
</dom-module>

<script>
    Polymer({
        is: "kubi-model",
        ready: function() {
            if(!modelConnectedVar) {
                kubiModel2.connect().then(function(err){
                    if(err) {
                        console.error(err);
                    } else {
                        modelConnectedVar = true;
                        try {
//                            this.fire("model-connected", {value: kubiModel2});
                        }catch (e){console.error(e);}
                        console.log("modelConnectedVar--",modelConnectedVar);

                    }
                });
            }
        },
        get model() {
            return kubiModel2;
        },
        set model(m) {
            kubiModel2 = m;
        },
        get modelConnectedV(){
            return modelConnectedVar;
        },
        modelAvailable : function() {
            return modelConnectedVar;
        },
        get lastTime() {
            return last_timestamp2;
        }
    });
</script>
<script>
    var dataBaseConnection2 = new org.kevoree.modeling.database.websocket.WebSocketClient("ws://" + location.host + "/cdn");
    var kubiModel2  = new org.kubi.KubiModel();
    kubiModel2.setContentDeliveryDriver(dataBaseConnection2);
    var modelConnectedVar = false;
    var last_timestamp2 = (new Date()).getTime();

</script>