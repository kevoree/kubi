<link rel="import" href="../../bower_components/polymer/polymer.html"/>


<!-- kubi model -->
<link rel="import" href="../kubi-model/kubi-model.html"/>


<script type="text/javascript" src="/js/paperclip.js"></script>
<script type="text/javascript" src="/js/parser.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.0/js/materialize.min.js"></script>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.0/css/materialize.min.css">
<link rel="stylesheet" type="text/css" href="kubi-stateMachine-basic-view.css"/>
<script src="./kubi-stateMachine-basic-view.js"></script>

<dom-module id="kubi-stateMachine-basic-view">
    <template>
        <kubi-model id="modelHandlerSlider" on-model-connected="modelConnected"></kubi-model>

        <div id="kubiStateMachineBasic">

        </div>

        <script id="kubiStateMachineBasicDropdown_template" type="text/x-handlebars-template">
            <div>
                <repeat each="{{stateMachine.states}}" as="state">
                <div>
                    <ul id="dropdown{{state.uuid}}" class="dropdown-content">
                        <repeat each="{{ state.toTransition }}" as="transition">
                            <repeat each="{{ transition.toState }}" as="toState">
                            <li>
                                <a href="#!">
                                    --> {{toState.name}} (probability : {{transition.probability}})
                                </a>
                            </li>
                            </repeat>
                        </repeat>
                    </ul>
                    <a class="btn dropdown-button" href="#!" data-activates="dropdown{{state.uuid}}">
                        {{state.name}} (outCounter : {{state | getOutCounter}} )
                        <i class="mdi-navigation-arrow-drop-down right"></i>
                    </a>
                </div>
                </repeat>

            </div>
        </script>
        <script id="kubiStateMachineBasic_template" type="text/x-handlebars-template">
            <div>
                <repeat each="{{stateMachine.states}}" as="state">
                <div class="tableFSM">
                    <ul id="table{{state.uuid}}" class="collection with-header">
                        <li class="collection-header">
                            <h5>{{state.name}} (reached {{state | getOutCounter}} times)</h5>
                        </li>
                        <repeat each="{{ state.toTransition }}" as="transition">
                            <repeat each="{{ transition.toState }}" as="toState">
                            <li class="collection-item">
                                <i class="small material-icons">trending_down</i>
                                {{toState.name}} (probability : {{transition.probability}}, time repartition : [{{transition.deltaMin}};{{transition.deltaMax}}])
                            </li>
                            </repeat>
                        </repeat>
                    </ul>
                </div>
                </repeat>

            </div>
        </script>




    </template>
</dom-module>

<script>
    Polymer({
        is: "kubi-stateMachine-basic-view",
        modelConnected : function(event, details){
            setFSMModel(details.value);
//            showBasicStateMachine("kubiStateMachineBasic");
            initTemplateFSM("kubiStateMachineBasic_template", "kubiStateMachineBasic")
//            initTemplateFSM("kubiStateMachineBasicDropdown_template", "kubiStateMachineBasic")
        },
        ready: function (){
        }
    });
</script>
