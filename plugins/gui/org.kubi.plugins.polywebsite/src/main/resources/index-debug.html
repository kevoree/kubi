<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
<head lang="en">
    <title>Smarthome Polymer</title>

    <script src="/js/js/org.kubi.model.js"></script>
    <script src="/js/js/org.kevoree.modeling.microframework.browser.js"></script>
    <script src="/js/js/org.kevoree.modeling.drivers.websocket.js"></script>

</head>
<body>


<script>
    var debugVar ={};
    // --------------
    debugVar.wsClient = new org.kevoree.modeling.drivers.websocket.WebSocketCDNClient("ws://" + location.host + "/cdn");
    debugVar.manager = org.kevoree.modeling.memory.manager.DataManagerBuilder.create().withContentDeliveryDriver(debugVar.wsClient).build();
    debugVar.model = new org.kubi.KubiModel(debugVar.manager);

    debugVar.model.connect(function(err){
        if(err) {
            console.error(err);
        } else {
            debugVar.model.lookup(0, 1440077899625, 4, function(obj){
                obj.allTimes(function(longs){
                    console.log("-->  ", longs.length);
                    for(var i=0;i<longs.length;i++){
                        console.log("**",longs[i]);
                    }
                });
//                console.log(obj,obj.toString(), obj.getValue());
            });

            debugVar.model.universe(0).time((new Date()).getTime()).getRoot(function(root){
                root.traversal()
                        .traverse(org.kubi.meta.MetaEcosystem.REF_TECHNOLOGIES)
                        .traverse(org.kubi.meta.MetaTechnology.REF_DEVICES)
                        .traverse(org.kubi.meta.MetaDevice.REF_STATEPARAMETERS)
                        .then(function(params){
                            console.log(params[0].getValue(), "---",params[0].now());
                });
            });

        }
    });


</script>

</body>
</html>